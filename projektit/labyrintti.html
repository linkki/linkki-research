<!DOCTYPE html>
<html lang="fi">

<head>
    <meta charset="utf-8">
    <title>Jäsäkurssi - Labyrinttipeli</title>
    <link href="../pohja/pohja.css" rel="stylesheet" type="text/css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.6/ace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.6/ext-language_tools.js"></script>
    <script src="../pohja/pohja.js"></script>
</head>

<body>

    <div class="header">
        <nav>
			Jäsää lapsille
			· <a href="../osa1/osa1.html">Osa 1</a>
			· <a href="../osa2/osa2.html">Osa 2</a>
			· <a href="../osa3/osa3.html">Osa 3</a>
			· <a href="../osa4/osa4.html">Osa 4</a>
			· <a href="../osa5/osa5.html">Osa 5</a>
			· <a href="../osa6/osa6.html">Osa 6</a>
			· <a href="../osa7/osa7.html">Osa 7</a>
			· <a href="../projektit/projektit.html">Projektit</a>
        </nav>
    </div>

    <div class="content">
        <h1>Labyrinttipeli</h1>
        <canvas id=kangas width=425 height=150 style=background-color:white></canvas>
        <button id=aloitaAlustaBtn>Aloita alusta.</button>

        <script>
            debug = false

            function etäisyys(hahmo1, hahmo2) {
                const dx = hahmo1.X - hahmo2.X
                const dy = hahmo1.Y - hahmo2.Y
                return Math.sqrt(dx * dx + dy * dy)
            }

            function laatikkoLiiku(suunta, laatikko, olikoMaalissa) {
                if (olikoMaalissa) {
                    kartta[laatikko.taulukkoY][laatikko.taulukkoX] = 2
                } else {
                    kartta[laatikko.taulukkoY][laatikko.taulukkoX] = 0
                }

                if (suunta === "ylös") {
                    laatikko.Y -= 25
                    laatikko.taulukkoY -= 1
                } else if (suunta === "alas") {
                    laatikko.Y += 25
                    laatikko.taulukkoY += 1
                } else if (suunta === "vasen") {
                    laatikko.X -= 25
                    laatikko.taulukkoX -= 1
                } else if (suunta === "oikea") {
                    laatikko.X += 25
                    laatikko.taulukkoX += 1

                }
                kartta[laatikko.taulukkoY][laatikko.taulukkoX] = 3
            }

            function osuuko(mihinOsutaan, laatikko, suunta) {
                if (suunta === "ylös") {
                    return kartta[laatikko.taulukkoY - 1][laatikko.taulukkoX] === mihinOsutaan
                }
                if (suunta === "alas") {
                    return kartta[laatikko.taulukkoY + 1][laatikko.taulukkoX] === mihinOsutaan
                }
                if (suunta === "vasen") {
                    return kartta[laatikko.taulukkoY][laatikko.taulukkoX - 1] === mihinOsutaan
                }
                if (suunta === "oikea") {
                    return kartta[laatikko.taulukkoY][laatikko.taulukkoX + 1] === mihinOsutaan
                }
            }

            function asetaMaaliin(laatikko) {
                kartta[laatikko.taulukkoY][laatikko.taulukkoX] = 4
            }

            function aloitaAlusta() {
                pelaaja.X = 50
                pelaaja.Y = 100
                pelaaja.taulukkoX = 2
                pelaaja.taulukkoY = 4
                pelaaja.suunta = "oikea"
                pelaaja.askeleet = 0

                laatikko1.X = 50
                laatikko1.Y = 50
                laatikko1.taulukkoX = 2
                laatikko1.taulukkoY = 2
                laatikko1.maali = false

                laatikko2.X = 125
                laatikko2.Y = 75
                laatikko2.taulukkoX = 5
                laatikko2.taulukkoY = 3
                laatikko2.maali = false

                laatikko3.X = 200
                laatikko3.Y = 75
                laatikko3.taulukkoX = 8
                laatikko3.taulukkoY = 3
                laatikko3.maali = false

                laatikko4.X = 275
                laatikko4.Y = 50
                laatikko4.taulukkoX = 11
                laatikko4.taulukkoY = 2
                laatikko4.maali = false

                kartta = [
                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                    [1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1],
                    [1, 2, 3, 0, 0, 0, 1, 0, 0, 1, 2, 3, 0, 0, 0, 0, 1],
                    [1, 0, 0, 1, 2, 3, 0, 2, 3, 0, 0, 0, 1, 0, 0, 0, 1],
                    [1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1],
                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
                ]
                piirrä()
            }
            const piirtäjä = kangas.getContext("2d")

            const pelaaja = {
                X: 50,
                Y: 100,
                taulukkoX: 2,
                taulukkoY: 4,
                suunta: "oikea",
                askeleet: 0
            }

            const laatikko1 = {
                X: 50,
                Y: 50,
                taulukkoX: 2,
                taulukkoY: 2,
                maali: false
            }

            const laatikko2 = {
                X: 125,
                Y: 75,
                taulukkoX: 5,
                taulukkoY: 3,
                maali: false
            }
            const laatikko3 = {
                X: 200,
                Y: 75,
                taulukkoX: 8,
                taulukkoY: 3,
                maali: false
            }
            const laatikko4 = {
                X: 275,
                Y: 50,
                taulukkoX: 11,
                taulukkoY: 2,
                maali: false
            }

            const laatikot = [laatikko1, laatikko2, laatikko3, laatikko4]


            aloitaAlustaBtn.onclick = () => {
                aloitaAlusta()
            }

            seinä = 1
            tyhjä = 0
            palkinto = 2
            laatikko = 3

            aloitaAlusta()
            pelaajaLiikkui = false
            document.onkeydown = event => {
                if (event.key == "ArrowUp") {
                    event.preventDefault()
                    if ((!osuuko(seinä, pelaaja, "ylös")) || debug) {
                        pelaaja.suunta = "ylös"
                        pelaaja.Y -= 25
                        pelaaja.taulukkoY -= 1
                        pelaajaLiikkui = true
                    }
                }
                if (event.key == "ArrowDown") {
                    event.preventDefault()
                    if ((!osuuko(seinä, pelaaja, "alas")) || debug) {
                        pelaaja.suunta = "alas"
                        pelaaja.Y += 25
                        pelaaja.taulukkoY += 1
                        pelaajaLiikkui = true
                    }
                }
                if (event.key == "ArrowLeft") {
                    if ((!osuuko(seinä, pelaaja, "vasen")) || debug) {
                        pelaaja.suunta = "vasen"
                        pelaaja.X -= 25
                        pelaaja.taulukkoX -= 1
                        pelaajaLiikkui = true
                    }
                }
                if (event.key == "ArrowRight") {
                    if ((!osuuko(seinä, pelaaja, "oikea")) || debug) {
                        pelaaja.suunta = "oikea"
                        pelaaja.X += 25
                        pelaaja.taulukkoX += 1
                        pelaajaLiikkui = true
                    }
                }

                for (laatikko of laatikot) {
                    if (etäisyys(pelaaja, laatikko) < 25) {
                        if (pelaaja.suunta === "ylös") {
                            if (osuuko(palkinto, laatikko, "ylös")) {
                                laatikkoLiiku("ylös", laatikko, false)
                                laatikko.maali = true
                                asetaMaaliin(laatikko)
                            } else if (osuuko(tyhjä, laatikko, "ylös")) {
                                if (laatikko.maali) {
                                    laatikkoLiiku("ylös", laatikko, true)
                                    laatikko.maali = false
                                } else {
                                    laatikkoLiiku("ylös", laatikko, false)
                                }
                            }
                            else {
                                pelaaja.Y += 25
                                pelaaja.taulukkoY += 1
                                pelaajaLiikkui = false
                            }
                        }

                        if (pelaaja.suunta === "vasen") {
                            if (osuuko(palkinto, laatikko, "vasen")) {
                                laatikkoLiiku("vasen", laatikko, false)
                                laatikko.maali = true
                                asetaMaaliin(laatikko)
                            } else if (osuuko(tyhjä, laatikko, "vasen")) {
                                if (laatikko.maali) {
                                    laatikkoLiiku("vasen", laatikko, true)
                                    laatikko.maali = false
                                } else {
                                    laatikkoLiiku("vasen", laatikko, false)
                                }
                            } else {
                                pelaaja.X += 25
                                pelaaja.taulukkoX += 1
                                pelaajaLiikkui = false
                            }

                        }

                        if (pelaaja.suunta === "oikea") {
                            if (osuuko(palkinto, laatikko, "oikea")) {
                                laatikkoLiiku("oikea", laatikko, false)
                                laatikko.maali = true
                                asetaMaaliin(laatikko)
                            } else if (osuuko(tyhjä, laatikko, "oikea")) {
                                if (laatikko.maali) {
                                    laatikkoLiiku("oikea", laatikko, true)
                                    laatikko.maali = false
                                } else {
                                    laatikkoLiiku("oikea", laatikko, false)
                                }
                            } else {
                                pelaaja.X -= 25
                                pelaaja.taulukkoX -= 1
                                pelaajaLiikkui = false
                            }

                        }

                        if (pelaaja.suunta === "alas") {
                            if (osuuko(palkinto, laatikko, "alas")) {
                                laatikkoLiiku("alas", laatikko, false)
                                laatikko.maali = true
                                asetaMaaliin(laatikko)
                            } else if (osuuko(tyhjä, laatikko, "alas")) {
                                if (laatikko.maali) {
                                    laatikkoLiiku("alas", laatikko, true)
                                    laatikko.maali = false
                                } else {
                                    laatikkoLiiku("alas", laatikko, false)
                                }
                            } else {
                                pelaaja.Y -= 25
                                pelaaja.taulukkoY -= 1
                                pelaajaLiikkui = false
                            }
                        }
                    }
                }
                if (pelaajaLiikkui) {
                    pelaaja.askeleet += 1
                }
            }

            function piirrä() {

                piirtäjä.clearRect(0, 0, 25 * 17, 25 * 6)
                for (let y = 0; y < 6; y++) {
                    for (let x = 0; x < 17; x++) {
                        if (kartta[y][x] === 1) {
                            piirtäjä.fillStyle = "grey"
                            piirtäjä.fillRect(25 * x, 25 * y, 25, 25)
                        }
                        if (kartta[y][x] === 2) {
                            piirtäjä.fillStyle = "yellow"
                            piirtäjä.fillRect(25 * x, 25 * y, 25, 25)
                        }
                        if (kartta[y][x] === 3) {
                            piirtäjä.fillStyle = "blue"
                            piirtäjä.fillRect(25 * x, 25 * y, 25, 25)
                        }
                        if (kartta[y][x] === 4) {
                            piirtäjä.fillStyle = "green"
                            piirtäjä.fillRect(25 * x, 25 * y, 25, 25)
                        }
                    }
                }
                //piirretään pelaaja
                piirtäjä.fillStyle = "red"
                piirtäjä.fillRect(pelaaja.X, pelaaja.Y, 25, 25)

                piirtäjä.font = '15px sans'
                piirtäjä.fillStyle = "black"
                piirtäjä.fillText("Askeleet: " + pelaaja.askeleet, 10, 20)

                voitto = true
                for (const laatikko of laatikot) {
                    if (!laatikko.maali) {
                        voitto = false
                    }
                }
                if (voitto) {
                    piirtäjä.fillStyle = "rgba(255, 255, 255, 0.5)";
                    piirtäjä.fillRect(0, 0, kangas.width, kangas.height);
                    piirtäjä.font = 'bold 40px sans'
                    piirtäjä.fillStyle = "black"
                    piirtäjä.fillText("Onneksi olkoon,", 25, 50)
                    piirtäjä.fillText("voitit pelin!", 50, 90)
                    piirtäjä.font = '25px sans'
                    piirtäjä.fillStyle = "black"
                    piirtäjä.fillText("Siirryit " + pelaaja.askeleet + " askelta.", 50, 125)

                    cancelAnimationFrame(piirrä)
                } else {
                    requestAnimationFrame(piirrä)
                }

            }
            requestAnimationFrame(piirrä)
        </script>

        <div class="note">
            <h3>Huom</h3>
            <p>
                Tämä peli on erityisen haastava toteuttaa. Olethan harjoitellut tarpeeksi!
            </p>
        </div>
        <h2>Alkuvalmistelut</h2>
        <p>Peli piirretään canvas alustalle, jonka koko on 425x150.
            Canvas alueen tunnisteeksi asetetaan "kangas" ja sen taustaväri on valkoinen.
            Lisätään myös painike, jolla pelin voi aloittaa alusta.
            Painikkeelle annetaan id.
            Voit toteuttaa canvaksen itse tai kopioida alla olevan pohjan.
            <script>codeExample(`<!doctype HTML>

                <canvas width = 425
                        height = 150
                        style = background-color:white;></canvas>

                <button id=aloitaAlustaBtn>Aloita alusta.</button>
                
                <script>
                
                ${closeScript}`, "html");</script>
        </p>
        <h2>Pelikentän piirtäminen</h2>
        <h3>Pelialueen tila talletetaan taulukkoon</h3>

        <p>
            Pelikentän tilaa ylläpidetään 2-ulotteisessa taulukossa.
            Taulukon leveys on 17 ja korkeus 6.
            Aseta taulukon arvot niin, että
            <ul>
                <li>Arvo 0 vastaa tyhjää tilaa</li>
                <li>Arvo 1 vastaa seinää</li>
                <li>Arvo 2 vastaa palkintoa</li>
                <li>Arvo 3 vastaa liikuteltavaa laatikkoa</li>
            </ul>
            Taulukon arvot ovat siis seuraavanlaiset
            <table>
                <tr>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>2</td>
                    <td>3</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>2</td>
                    <td>3</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>2</td>
                    <td>3</td>
                    <td>0</td>
                    <td>2</td>
                    <td>3</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                    <td>1</td>
                </tr>
            </table>
            Talleta taulukko muuttujaan <b>kenttä</b>.
        </p>

        <h3>Pelialueen piirtäminen</h3>
        <p>Pelikenttä piirretään <code>piirrä()</code> funktiolla.
            Funktion sisällä käydään kenttä taulukkoa läpi.
            Kun tarkastelemme taulukon alkioita yksi kerrallaan,
            niin haluamme piirtää kankaalle ruutuja.</p>
        <p>Jokainen ruutu on 25 pikseliä leveä ja 25 pikseliä korkea. </p>

        <li>
            <ul>Jos taulukon alkiossa on arvo 1, niin pelikentälle piirretään harmaa ruutu.</ul>
            <ul>Taulukossa alkion arvo 2 kertoo, että siinä on siirrettävä laatikko.
                Ruudun väri on tällöin sininen.
            </ul>
            <ul>Alkion arvo 3 tarkoittaa, että kohdassa on maali ruutu.
                Maali ruutua vastaava ruutu on väriltään keltainen.
            </ul>
        </li>
        <p>
            Jokainen laatikko on 25 pikselin etäisyydellä toisistaan,
            joten piirretään ne kertomalla taulukon indeksejä luvulla 25.
        </p>
        <p>TODO: lisää kuva labyrintistä ilman pelaajaa.</p>
        <p>Muista laittaa piirto funktion alkuun piirtoalueen tyhjentävä komento.</p>
        <br>
        <h3>Pelaajan piirtäminen</h3>
        <p>Pelaaja piirretään piirto funktion sisällä, kuten kenttäkin.
            Pelaajan sijainnista ei kuitenkaan pidetä kirjaa taulukossa.
            Pelaajan sijainnista tulee kuitenkin pitää kirjaa jollakin tavalla.
            Pidetään pelaajan sijainnista kirjaa luomalla pelaajasta objekti.
            Luo oliomuuttuja pelaaja, jolla on ominaisuudet X ja Y.
            Näiden ominaisuuksien on tarkoitus pitää kirjaa pelaajan sijainnista.
            Pelaajan X-sijainti on aluksi 25*2=50 ja Y-sijainti on 25*4=100.
        </p>
        <p>Kun pelaajasta on luotu oliomuuttuja,
            niin pelaaja piirretään piirto funktiossa.
            Asetetaan pelaajan väri punaiseksi ja piirretään se 25*25 ruutuna pelaaja oliomuuttujan X ja Y sijainteihin.
        </p>
        <p>Nyt meillä on siis piirrettynä kaikki pelikentälle tarvittava.
            Talletetaan muuttujiin tieto mmillä merkkaamme seinää, tyhjää, palkintoa ja laatikkoa taulukossa.
            Koodataan vielä pelin itse ohjelmallisuus.
        </p>
        <h3>Laatikoiden hallinta</h3>
        <p>
            Haluamme päästä nopeasti käsiksi erityisesti liikkuvien laatikoiden sijaintiin,
            joten haluamme tallentaa niistä tärkeimmäit tiedot objekteihin.
            Tälläiset tiedot ovat
            <ul>
                <li>laatikon sijainti taulukossa</li>
                <li>laatikon sijainti canvas alueella</li>
            </ul>
            Luo tarvittavat objektit ja talleta niihin siirreltävien laatikoiden 1,2,3 ja 4 taulukon X ja Y
            koordinaatit,
            sekä kankaalla olevat X ja Y koordinaatit.
        </p>

        <h2>Pelihahmon liikkuminen</h2>

        <p> Pelihahmoa liikutetaan nuolinäppäimistä.
            Tehdään siis jokaiselle näppäimelle kuuntelija ja lisätään pelaajan oliolle tieto liikkeen suunnasta.
            Alussa pelaajan suunta on aina "oikea".
        </p>
        <p>Nyt kun nuolinäppäimiä painetaan niin koko sivu liikkuu näppäinten mukana.
            Lisätään jokaiseen näppäimen kuuntelijään koodi <code>event.preventDefault()</code>.
            Tämä estää sivustoa liikkumasta aina kuin näppäintä painetaan.
        </p>
        <p> Kun nuoli näppäin painetaan, niin pelaaja suunta muuttuu näppäintä vastaavaksi.
            Vaihdetaan suuntaa tallettamalla pelaajan suunta muuttujaan merkkijonona painetun näppäimen suunta.
            Pelaajan sijainti vaihtuu 25 pikseliä kerralla joko Y tai X suunnassa.
            Lisäksi haluamme pävittää pelaajan sijaintia taulukossa myöskin X tai Y suuntaan.
        </p>

        <p> Tarkasta, että pelaaja liikkuu joka suuntaan.</p>

        <p> Pelaaja pystyy liikkumaan tällä hetkellä myös seinien läpi, eikä laatikotkaan liiku,
            jos niihin osuu.
            Aina kun nuolinäppäintä painetaan, niin haluamme myös tarkistaa,
            voiko haluttuun suuntaan liikkua.
            Pelissä ylipäätään halutaan tarkistaa erilaisia osumia,
            onhan tarkasstettava osummeko laatikkoon,
            osuuko laatikko maaliin ja osuuko laatikko seinään.
            Vaikuttaa siltä, että haluamme tarkistaa useampia osumia.
            Luodaan siis tarkoitusta varten <b>funktio.</b>
        </p>
        <p> Annetaan funktiolle nimeksi "osuuko".
            Funktio saa arvokseen kolme parametria: <code>mihinOsutaan</code>, <code>laatikko</code> ja
            <code>suunta</code>.

            Funktiossa haluamme tarkastella kaikkia eri suuntia seruaavasti
            Jos suunta on "ylös", niin palautamme vertailun.
            Vertailu vertailee laatikon yläpuolella olevaa alkiota siihen mitä haluamme tarkastella.
            Tämä toimii myös pelaajan kohdalla, sillä pelaaja on yhdenlainen laatikko.
            Huomasitko, että pelaajalla ja laatikoilla onkin hyvin samanlainen rakenne.

            Funktio voi siis vastata kysymyksiin "Osuuko pelaaja seinään?",
            "Osuuko laatikko seinään?" ja "Osuuko pelaaja laatikkoon?".

        </p>

        <h2>Laatikoiden siirtäminen</h2>

        Jokaisella kerralla kun mitä tahansa näppäintä painetaan,
        tulee tarkistaa osuuko pelaaja johonkin laatikkoon.
        Aina kuin näppäintä painetaan käydään jokainen laatikko läpi laatikot-listassa.
        Tehdään tämän for-loopin sisälle laatikoille tarvittava toiminnallisuus neljässä osassa.

        <h3>Pelaaja liikuttaa laatikkoa</h3>
        <p>Kun pelaaja osuu laatikkoon,
            niin laatikon on tarkoitus liikkua.
            Ensimmäisena haluamme tarkistaa jokaisen laatikon kohdalla,
            onko pelaajan ja laatikon etäisyys pienempi kuin 25.
            Lisätään koodiin siis etäisyys-funktio,
            joka saa parametrikseen kaksi hahmoa.
            Käytetään etäisyys funktiota jos-lauseessa,
            jossa tarkastelemme,
            onko etäisyys pienempi kuin 25.
        </p>
        <p>Kun etäisyys on pienempi kuin 25,
            niin tiedämme,
            että pelaaja osuu johonkin laatikkoon.
            Pelaajan osuessa laatikkoon liikutetaan laatikkoa oikeaan suuntaan.
            Pelaajan on tarkoitus työntää laatikkoa pois itsestään.
            Otetaan ensin selvää neljällä if-lauseella,
            mihin suuntaan pelaaja on liikkumassa.
            Kun tiedämme mihin suuntaan pelaaja liikkuu,
            voimme liikuttaa laatikkoa sen perusteeella.
        </p>
        <p>Tehdään laatikon liikuttamista varten oma funktio.
            Annetaan funktiolle nimeksi laatikkoLiiku.
            laatikkoLiiku saa parametrikseen suunnan,
            mihin haluamme liikuttaa laatikkoa ja laatikon, jota haluamme liikuttaa.
            Funktiossa asetamme laatikon nykyisen sijainnin arvoksi kartassa 0 eli merkkaamme sen tyhjäksi.
            Tämän jälkeen laatikkoa siirretään parametrina annetun suunnan perusteella joko ylös, alas, vasemmalle tai
            oikealle.
            Voimme käyttää tapausten tarkastelussa else-if rakennetta.
            If-else rakenteessa vähennetään tai lisätään laatikon X tai Y arvoon 25 riippuen mihin suuntaan laatikko
            liikkuu.
            Tämän lisäksi if-else lohkojen sisällä muutamme laatikon taulukkoX tai taulukkoY sijaintia lisäämällä tai
            vähentämällä arvosta 1.
            Lopuksi if-else lohkon jälkeen muutamme kartan alkion arvoa uusilla laatikon taulukkoX ja taulukkoY arvoilla
            niin,
            että uudessa sijainnissa on arvo 3.
        </p>
        <p>Jokaiselle suunnalle toteutetaan sama toiminnallisuus.</p>
        <p>Vinkki: kannattaa ensin saada yksi suunta toimimaan.</p>
        <h3>Estetään laatikon karkaaminen pelikentältä</h3>
        <p>Haluamme estää laatikon menemästä seinien läpi. 
            Käytetään tähän tarkasteluun osuuko-funktiota. 
            Annetaan osuuko-funktiolle parametreina tyhjä, laatikko ja suunta johon pelaaja on liikkumassa. 
            Jos osuuko funktio palauttaa tosi-arvon, 
            niin laatikkoa voi liikuttaa pelaajan suuntaan. 
            Muutoin laatikko tai pelaaja ei voi liikkua. 
            TODO: Kuva pelaajasta ja laatikosta jumissa. 
        </p>
        <p>Refaktoroi koodi niin, 
            että laatikkoLiiku funktiota kutsutaan vain jos osuuko-funktio kertoo, 
            että olemme siirtämässä laatikkoa tyhjään kohtaan. 
            Muutoin peru pelaajan liikkuminen asettamalla pelaajan sijainti taulukossa ja kankaalla nuolinäppäimella liikkumisen vastaiseksi.  
        </p>

        <h3>Liikutetaan laatikko maaliin</h3>
        <p>Huomaamme, että on kahdellaisia paikkoja, jossa laatikko voi sijaita. 
            Laatikko voi olla joko pelikentän tyhjällä alueella tai maalialueella. 
            Kun laatikko osuu maalialueelle myös sen väri vaihtuu. 
            Merkataan kartassa maalissa olevaa arretta arvolla 4. 
        </p>
        <p>Tehdään maaliin asettamista varten oma funktio. 
            Annetaan funktiolle nimeksi asetaMaaliin. 
            asetaMaalii funktiolle annetaan parametreiksi laatikko, 
            joka on osumassa maali neliöön. 
            Funktion tarkoitus on merkata karttaan laatikon alkion arvoksi 4.
        </p>
        <p>asetaMaaliin-funktio ei osaa tarkistaa, 
            onko laatikko oikeasti maalissa. 
            Sen tehtävä on ainoastaan asettaa laatikko maaliin. 
            Näin ollen meidän täytyy tarkistaa ennen funktion kutsumista, 
            onko laatikko maalissa.
        </p>
        <p>Refaktoroidaan koodia niin, 
            että lisätään osuuko laatikko tyhjään tarkastelun lisäksi tarkastelu siitä, 
            että osuuko laatikko maaliin. 
            Käytämme tarkasteluun else-if rakennetta. 
            Tarkastellaan jälleen osuuko-funktiolla, 
            osuuko laatikko maaliin. 
            Annetaan tällä kertaa funktiolle parametreina palkinto, laatikko, jota käsitellään ja suunta, johon laatikko on liikkumassa eli pelaajan suunta. 
            Lisätään laatikolle oliomuuttujan maali. 
        </p>
        <p>Lisätään myös funktiolle laatikkoLiiku tieto siitä, 
            että onko laatikko maalissa. 
            Lisätään siis laatikkoLiiku-funktiolle parametri olikoMaalissa. 
            Nyt laatikkoLiiku funktiolla on kolme parametria suunta, laatikko ja olikoMaalissa. 
            olikoMaalissa parametri kertoo, onko liikutettava laatikko maalissa. 
            Lisätän funktion alkuun tarkastelu eli jos ehto. 
            Jos olikoMaalissa on tosi, 
            niin asetetaan kartan alkion arvoksi maalin arvo eli arvo 2. 
            Muutoin asetamme alkion arvoksi 0, kuten ennenkin.
        </p>
        <p>Tip: Haluamme siis asettaa alkion arvoksi, 
            josta pelaaja poistaa, sen arvon joka siinä olikin. 
        </p>
        <p>Nyt laatikon liikkumista, 
            kun osutaan tyhjään on muutettava niin, 
            että tarkastelemme ennen laatikon liikuttamista oliko laatikko maalissa. 
            Tarkastelun voi toteuttaa if-else rakenteen avulla siten, 
            että ennen kuin laatikkoa liikutetaan tarkastellaan, 
            oliko laatikon maali-muuttujan arvo tosi. 
            Jos maali-muuttujan arvo on tosi, niin 
            annamme laatikkoLiiku funktion parametreiksi suunnan, laatikon ja "true"-arvon. 
            Lisäksi asetetaan laatikon maali muuttujan arvoksi "false". 
            Muution liikutetaan laatikkoa kuten tavallisesti, mutta annetaan funktiolle parametriksi "false".
        </p>
        <p>
            Jos laatikko osuu maaliin, niin liikutamme laatikkoa. 
            Laatikon liikuttamisessa annamme kolmanneksi parametriksi "false", 
            sillä laatikko ei ole siirtymässä pois maalista. 
            Lisäksi haluamme merkata laatikon maali muuttujan arvoksi true ja käyttää aseta maaliin funktiota. 
        </p>

        <h3>Liikutetaan laatikko pois maalista</h3>

        <h2>Pelin voittaminen (ja loput)</h2>

    </div>
</body>

</html>
